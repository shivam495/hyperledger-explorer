{"ast":null,"code":"import _regeneratorRuntime from\"/home/shivam/blockchain-explorer/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/shivam/blockchain-explorer/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/**\n *    SPDX-License-Identifier: Apache-2.0\n */import React,{Component}from'react';import compose from'recompose/compose';import{connect}from'react-redux';import{withStyles}from'@material-ui/core/styles';import Avatar from'@material-ui/core/Avatar';import Button from'@material-ui/core/Button';import FormControl from'@material-ui/core/FormControl';import FormHelperText from'@material-ui/core/FormHelperText';import InputAdornment from'@material-ui/core/InputAdornment';import TextField from'@material-ui/core/TextField';import Paper from'@material-ui/core/Paper';import Typography from'@material-ui/core/Typography';import MenuItem from'@material-ui/core/MenuItem';import ListIcon from'@material-ui/icons/List';import PersonIcon from'@material-ui/icons/Person';import LockOutlinedIcon from'@material-ui/icons/LockOutlined';import{authSelectors,authOperations}from'../../state/redux/auth';const styles=theme=>({container:{width:'auto',display:'block',// Fix IE 11 issue.\nmarginLeft:theme.spacing.unit*3,marginRight:theme.spacing.unit*3,[theme.breakpoints.up(400+theme.spacing.unit*3*2)]:{width:400,marginLeft:'auto',marginRight:'auto'}},paper:{marginTop:theme.spacing.unit*8,display:'flex',flexDirection:'column',alignItems:'center',padding:\"\".concat(theme.spacing.unit*2,\"px \").concat(theme.spacing.unit*3,\"px \").concat(theme.spacing.unit*3,\"px\")},avatar:{margin:theme.spacing.unit,backgroundColor:theme.palette.secondary.main},form:{width:'100%',// Fix IE 11 issue.\nmarginTop:theme.spacing.unit},submit:{marginTop:theme.spacing.unit*3},errortext:{fontSize:16,font:'bold',color:'red'}});export class Login extends Component{constructor(props){var _this;super(props);_this=this;this.handleChange=event=>{const target=event.target;const value=target.type==='checkbox'?target.checked:target.value;const name=target.name;const newState={[name]:{value}};if(name==='network'){const networks=this.state.networks;newState.authEnabled=(networks.find(n=>n.name===value)||{}).authEnabled;}this.setState(newState);};this.submitForm=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _this$state,user,password,network;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();_this$state=_this.state,user=_this$state.user,password=_this$state.password,network=_this$state.network;_context.next=4;return _this.performLogin({user:user.value,password:password.value,network:network.value});case 4:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();const _props$networks=props.networks,_networks=_props$networks===void 0?[]:_props$networks;this.state={info:null,user:{error:null,value:''},password:{error:null,value:''},network:{error:null,value:''},autoLoginAttempted:false,error:'',networks:_networks,authEnabled:false,isLoading:false};}componentWillReceiveProps(nextProps){const _nextProps$networks=nextProps.networks,networks=_nextProps$networks===void 0?[]:_nextProps$networks;this.setState(()=>({networks,network:{error:null,value:networks[0].name||''},authEnabled:networks[0].authEnabled}));}performLogin({user,password,network}){var _this2=this;return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var login,authEnabled,info,history;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:login=_this2.props.login;authEnabled=_this2.state.authEnabled;_context2.next=4;return login({user:authEnabled?user:'dummy-user',password:authEnabled?password:'dummy-password'},network);case 4:info=_context2.sent;_this2.setState(()=>({info}));if(!(info.status==='Success')){_context2.next=10;break;}history=_this2.props.history;history.replace('/');return _context2.abrupt(\"return\",true);case 10:case\"end\":return _context2.stop();}},_callee2);}))();}componentDidUpdate(){var _this3=this;return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this3$state,networks,autoLoginAttempted;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_this3$state=_this3.state,networks=_this3$state.networks,autoLoginAttempted=_this3$state.autoLoginAttempted;// If we have only one network and it doesn't have auth enabled, perform a login\n// autoLoginAttempted is a safety to prevent multiple tries\nif(!(networks.length===1&&!networks[0].authEnabled&&!autoLoginAttempted)){_context3.next=5;break;}_this3.setState(()=>({autoLoginAttempted:true}));_context3.next=5;return _this3.performLogin({network:networks[0].name});case 5:case\"end\":return _context3.stop();}},_callee3);}))();}render(){const _this$state2=this.state,info=_this$state2.info,user=_this$state2.user,password=_this$state2.password,network=_this$state2.network,networks=_this$state2.networks,authEnabled=_this$state2.authEnabled,isLoading=_this$state2.isLoading;const _this$props=this.props,classes=_this$props.classes,error=_this$props.error;return/*#__PURE__*/React.createElement(\"div\",{className:classes.container},/*#__PURE__*/React.createElement(Paper,{className:classes.paper},/*#__PURE__*/React.createElement(Avatar,{className:classes.avatar},/*#__PURE__*/React.createElement(LockOutlinedIcon,null)),/*#__PURE__*/React.createElement(Typography,{component:\"h5\",variant:\"headline\"},\"Sign in\"),/*#__PURE__*/React.createElement(\"form\",{className:classes.form,onSubmit:this.submitForm},/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",required:true,fullWidth:true},/*#__PURE__*/React.createElement(TextField,{required:true,fullWidth:true,select:true,id:\"network\",name:\"network\",label:\"Network\",disabled:isLoading,value:network.value,onChange:e=>this.handleChange(e),margin:\"normal\",InputProps:{startAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"start\"},/*#__PURE__*/React.createElement(ListIcon,null)),shrink:'true'}},networks.map(item=>/*#__PURE__*/React.createElement(MenuItem,{key:item.name,value:item.name},item.name))),network.error&&/*#__PURE__*/React.createElement(FormHelperText,{id:\"component-error-text\",error:true},network.error)),authEnabled&&/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",required:true,fullWidth:true},/*#__PURE__*/React.createElement(TextField,{error:!!user.error,required:true,fullWidth:true,id:\"user\",name:\"user\",label:\"User\",disabled:isLoading,value:user.value,onChange:e=>this.handleChange(e),margin:\"normal\",InputProps:{startAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"start\"},/*#__PURE__*/React.createElement(PersonIcon,null)),shrink:'true'}}),user.error&&/*#__PURE__*/React.createElement(FormHelperText,{id:\"component-error-text\",error:true},user.error)),authEnabled&&/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",required:true,fullWidth:true},/*#__PURE__*/React.createElement(TextField,{required:true,fullWidth:true,error:!!password.error,id:\"password\",type:\"password\",name:\"password\",label:\"Password\",disabled:isLoading,value:password.value,onChange:e=>this.handleChange(e),margin:\"normal\",InputProps:{startAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"start\"},/*#__PURE__*/React.createElement(LockOutlinedIcon,null)),shrink:'true'}}),password.error&&/*#__PURE__*/React.createElement(FormHelperText,{id:\"component-error-text\",error:true},password.error)),error&&/*#__PURE__*/React.createElement(FormHelperText,{id:\"component-error-text\",error:true},error),info&&/*#__PURE__*/React.createElement(FormHelperText,{id:\"component-error-text\",className:classes.errortext},info.message),/*#__PURE__*/React.createElement(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.submit},authEnabled?\"Sign in\":\"Connect\"))));}}const authSelector=authSelectors.authSelector,errorSelector=authSelectors.errorSelector,networkSelector=authSelectors.networkSelector;export default compose(withStyles(styles),connect(state=>({auth:authSelector(state),error:errorSelector(state),networks:networkSelector(state)}),{login:authOperations.login}))(Login);","map":{"version":3,"sources":["/home/shivam/blockchain-explorer/client/src/components/Login/Login.js"],"names":["React","Component","compose","connect","withStyles","Avatar","Button","FormControl","FormHelperText","InputAdornment","TextField","Paper","Typography","MenuItem","ListIcon","PersonIcon","LockOutlinedIcon","authSelectors","authOperations","styles","theme","container","width","display","marginLeft","spacing","unit","marginRight","breakpoints","up","paper","marginTop","flexDirection","alignItems","padding","avatar","margin","backgroundColor","palette","secondary","main","form","submit","errortext","fontSize","font","color","Login","constructor","props","handleChange","event","target","value","type","checked","name","newState","networks","state","authEnabled","find","n","setState","submitForm","e","preventDefault","user","password","network","performLogin","info","error","autoLoginAttempted","isLoading","componentWillReceiveProps","nextProps","login","status","history","replace","componentDidUpdate","length","render","classes","startAdornment","shrink","map","item","message","authSelector","errorSelector","networkSelector","auth"],"mappings":"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","sourcesContent":["/**\n *    SPDX-License-Identifier: Apache-2.0\n */\n\nimport React, { Component } from 'react';\n\nimport compose from 'recompose/compose';\nimport { connect } from 'react-redux';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Avatar from '@material-ui/core/Avatar';\nimport Button from '@material-ui/core/Button';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport TextField from '@material-ui/core/TextField';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nimport ListIcon from '@material-ui/icons/List';\nimport PersonIcon from '@material-ui/icons/Person';\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\n\nimport { shape, string } from 'prop-types';\n\nimport { authSelectors, authOperations } from '../../state/redux/auth';\n\nconst styles = theme => ({\n\tcontainer: {\n\t\twidth: 'auto',\n\t\tdisplay: 'block', // Fix IE 11 issue.\n\t\tmarginLeft: theme.spacing.unit * 3,\n\t\tmarginRight: theme.spacing.unit * 3,\n\t\t[theme.breakpoints.up(400 + theme.spacing.unit * 3 * 2)]: {\n\t\t\twidth: 400,\n\t\t\tmarginLeft: 'auto',\n\t\t\tmarginRight: 'auto'\n\t\t}\n\t},\n\tpaper: {\n\t\tmarginTop: theme.spacing.unit * 8,\n\t\tdisplay: 'flex',\n\t\tflexDirection: 'column',\n\t\talignItems: 'center',\n\t\tpadding: `${theme.spacing.unit * 2}px ${theme.spacing.unit * 3}px ${theme\n\t\t\t.spacing.unit * 3}px`\n\t},\n\tavatar: {\n\t\tmargin: theme.spacing.unit,\n\t\tbackgroundColor: theme.palette.secondary.main\n\t},\n\tform: {\n\t\twidth: '100%', // Fix IE 11 issue.\n\t\tmarginTop: theme.spacing.unit\n\t},\n\tsubmit: {\n\t\tmarginTop: theme.spacing.unit * 3\n\t},\n\terrortext: {\n\t\tfontSize: 16,\n\t\tfont: 'bold',\n\t\tcolor: 'red'\n\t}\n});\n\nexport class Login extends Component {\n\tstatic propTypes = {\n\t\tclasses: shape({\n\t\t\tavatar: string,\n\t\t\tform: string,\n\t\t\tcontainer: string,\n\t\t\tpaper: string,\n\t\t\tsubmit: string\n\t\t}).isRequired\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst { networks = [] } = props;\n\t\tthis.state = {\n\t\t\tinfo: null,\n\t\t\tuser: {\n\t\t\t\terror: null,\n\t\t\t\tvalue: ''\n\t\t\t},\n\t\t\tpassword: {\n\t\t\t\terror: null,\n\t\t\t\tvalue: ''\n\t\t\t},\n\t\t\tnetwork: {\n\t\t\t\terror: null,\n\t\t\t\tvalue: ''\n\t\t\t},\n\t\t\tautoLoginAttempted: false,\n\t\t\terror: '',\n\t\t\tnetworks,\n\t\t\tauthEnabled: false,\n\t\t\tisLoading: false\n\t\t};\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tconst { networks = [] } = nextProps;\n\t\tthis.setState(() => ({\n\t\t\tnetworks,\n\t\t\tnetwork: {\n\t\t\t\terror: null,\n\t\t\t\tvalue: networks[0].name || ''\n\t\t\t},\n\t\t\tauthEnabled: networks[0].authEnabled\n\t\t}));\n\t}\n\n\thandleChange = event => {\n\t\tconst { target } = event;\n\t\tconst value = target.type === 'checkbox' ? target.checked : target.value;\n\t\tconst { name } = target;\n\n\t\tconst newState = {\n\t\t\t[name]: { value }\n\t\t};\n\t\tif (name === 'network') {\n\t\t\tconst { networks } = this.state;\n\t\t\tnewState.authEnabled = (networks.find(n => n.name === value) || {}).authEnabled;\n\t\t}\n\n\t\tthis.setState(newState);\n\t};\n\n\tasync performLogin({ user, password, network}) {\n\t\tconst { login } = this.props;\n\t\tconst { authEnabled } = this.state;\n\n\t\tconst info = await login(\n\t\t\t{\n\t\t\t\tuser: authEnabled ? user : 'dummy-user',\n\t\t\t\tpassword: authEnabled ? password : 'dummy-password',\n\t\t\t},\n\t\t\tnetwork\n\t\t);\n\n\t\tthis.setState(() => ({ info }));\n\t\tif (info.status === 'Success') {\n\t\t\tconst { history } = this.props;\n\t\t\thistory.replace('/');\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tsubmitForm = async e => {\n\t\te.preventDefault();\n\n\t\tconst { user, password, network } = this.state;\n\n\t\tawait this.performLogin({\n\t\t\tuser: user.value,\n\t\t\tpassword: password.value,\n\t\t\tnetwork: network.value\n\t\t});\n\t};\n\n\tasync componentDidUpdate() {\n\t\tconst { networks, autoLoginAttempted } = this.state;\n\n\t\t// If we have only one network and it doesn't have auth enabled, perform a login\n\t\t// autoLoginAttempted is a safety to prevent multiple tries\n\t\tif (networks.length === 1 && !networks[0].authEnabled && !autoLoginAttempted) {\n\t\t\tthis.setState(() => ({\n\t\t\t\tautoLoginAttempted: true\n\t\t\t}));\n\t\t\tawait this.performLogin({ network: networks[0].name })\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { info, user, password, network, networks, authEnabled, isLoading } = this.state;\n\t\tconst { classes, error } = this.props;\n\n\t\treturn (\n\t\t\t<div className={classes.container}>\n\t\t\t\t<Paper className={classes.paper}>\n\t\t\t\t\t<Avatar className={classes.avatar}>\n\t\t\t\t\t\t<LockOutlinedIcon />\n\t\t\t\t\t</Avatar>\n\t\t\t\t\t<Typography component=\"h5\" variant=\"headline\">\n\t\t\t\t\t\tSign in\n\t\t\t\t\t</Typography>\n\t\t\t\t\t<form className={classes.form} onSubmit={this.submitForm}>\n\t\t\t\t\t\t<FormControl margin=\"normal\" required fullWidth>\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\tselect\n\t\t\t\t\t\t\t\tid=\"network\"\n\t\t\t\t\t\t\t\tname=\"network\"\n\t\t\t\t\t\t\t\tlabel=\"Network\"\n\t\t\t\t\t\t\t\tdisabled={isLoading}\n\t\t\t\t\t\t\t\tvalue={network.value}\n\t\t\t\t\t\t\t\tonChange={e => this.handleChange(e)}\n\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\t\tstartAdornment: (\n\t\t\t\t\t\t\t\t\t\t<InputAdornment position=\"start\">\n\t\t\t\t\t\t\t\t\t\t\t<ListIcon />\n\t\t\t\t\t\t\t\t\t\t</InputAdornment>\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tshrink: 'true'\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{networks.map(item => (\n\t\t\t\t\t\t\t\t\t<MenuItem key={item.name} value={item.name}>\n\t\t\t\t\t\t\t\t\t\t{item.name}\n\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TextField>\n\t\t\t\t\t\t\t{network.error && (\n\t\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" error>\n\t\t\t\t\t\t\t\t\t{network.error}\n\t\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t{authEnabled && (\n\t\t\t\t\t\t\t<FormControl margin=\"normal\" required fullWidth>\n\t\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t\terror={!!user.error}\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\tid=\"user\"\n\t\t\t\t\t\t\t\t\tname=\"user\"\n\t\t\t\t\t\t\t\t\tlabel=\"User\"\n\t\t\t\t\t\t\t\t\tdisabled={isLoading}\n\t\t\t\t\t\t\t\t\tvalue={user.value}\n\t\t\t\t\t\t\t\t\tonChange={e => this.handleChange(e)}\n\t\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\t\t\tstartAdornment: (\n\t\t\t\t\t\t\t\t\t\t\t<InputAdornment position=\"start\">\n\t\t\t\t\t\t\t\t\t\t\t\t<PersonIcon />\n\t\t\t\t\t\t\t\t\t\t\t</InputAdornment>\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\tshrink: 'true'\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{user.error && (\n\t\t\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" error>\n\t\t\t\t\t\t\t\t\t\t{user.error}\n\t\t\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{authEnabled && (\n\t\t\t\t\t\t\t<FormControl margin=\"normal\" required fullWidth>\n\t\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\terror={!!password.error}\n\t\t\t\t\t\t\t\t\tid=\"password\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\t\t\t\tlabel=\"Password\"\n\t\t\t\t\t\t\t\t\tdisabled={isLoading}\n\t\t\t\t\t\t\t\t\tvalue={password.value}\n\t\t\t\t\t\t\t\t\tonChange={e => this.handleChange(e)}\n\t\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\t\t\tstartAdornment: (\n\t\t\t\t\t\t\t\t\t\t\t<InputAdornment position=\"start\">\n\t\t\t\t\t\t\t\t\t\t\t\t<LockOutlinedIcon />\n\t\t\t\t\t\t\t\t\t\t\t</InputAdornment>\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\tshrink: 'true'\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{password.error && (\n\t\t\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" error>\n\t\t\t\t\t\t\t\t\t\t{password.error}\n\t\t\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{error && (\n\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" error>\n\t\t\t\t\t\t\t\t{error}\n\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{info && (\n\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" className={classes.errortext}>\n\t\t\t\t\t\t\t\t{info.message}\n\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\tclassName={classes.submit}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{authEnabled ? \"Sign in\" : \"Connect\"}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</form>\n\t\t\t\t</Paper>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nconst { authSelector, errorSelector, networkSelector } = authSelectors;\n\nexport default compose(\n\twithStyles(styles),\n\tconnect(\n\t\tstate => ({\n\t\t\tauth: authSelector(state),\n\t\t\terror: errorSelector(state),\n\t\t\tnetworks: networkSelector(state)\n\t\t}),\n\t\t{\n\t\t\tlogin: authOperations.login\n\t\t}\n\t)\n)(Login);\n"]},"metadata":{},"sourceType":"module"}